<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SARA AI - Text Test</title>
    <style>
        body { font-family: sans-serif; background: #121212; color: white; padding: 50px; text-align: center; }
        #response-box { 
            background: #222; border: 2px solid #444; padding: 20px; 
            min-height: 100px; width: 60%; margin: 20px auto; border-radius: 10px;
            font-size: 1.2rem; line-height: 1.5; color: #4db8ff;
        }
        input { padding: 10px; width: 50%; border-radius: 5px; border: none; }
        button { padding: 10px 20px; background: #4db8ff; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>
    <h1>üéôÔ∏è SARA AI (Brain: Gemini 2.5)</h1>
    
    <!-- This ID must match the script below -->
    <div id="response-box">Waiting for message...</div>

    <input type="text" id="userInput" placeholder="Type 'How are you?'">
    <button onclick="sendToSARA()">Send</button>

    <script>
        const socket = new WebSocket(`ws://${window.location.host}/ws/chat`);
        const responseBox = document.getElementById('response-box');

        socket.onopen = () => { console.log("Connected to SARA"); };

        socket.onmessage = (event) => {
            console.log("Chunk received:", event.data);
            
            if (event.data === "<END>") {
                console.log("Response Finished");
            } else {
                // Clear "Thinking..." or initial text on first chunk
                if (responseBox.innerText === "Thinking..." || responseBox.innerText === "Waiting for message...") {
                    responseBox.innerText = "";
                }
                // Append the word/chunk
                responseBox.innerText += event.data;
            }
        };

        function sendToSARA() {
            const input = document.getElementById('userInput');
            if (input.value) {
                responseBox.innerText = "Thinking...";
                socket.send(input.value);
                input.value = "";
            }
        }
    </script>
</body>
</html>